---
title: "Portfolio 7"
---

#libraries

```{r libraries}
library(tidytuesdayR)
library(tidyverse)
library(ggplot2)
library(forcats)
```


#RollingStone Data
For this portfolio, i am exploring the tidytuesday data on Rolling Stone Album Rankings.

*Might analyze something about how from 2003, 2012, and then 2020 there are shifts in which albums are included??? possible changes in release_year or genre or spotify popularity*

```{r getdata}
rolling_stone <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2024/2024-05-07/rolling_stone.csv')

```

#convert to long
```{r long}
rolling_stone_long <- rolling_stone %>%
  pivot_longer(
    cols = starts_with("rank_"),
    names_to = "rs_year",
    names_prefix = "rank_",
    values_to = "rank"
  ) %>%
  filter(!is.na(rank)) %>%  
    mutate(rs_year = as.integer(rs_year))

```



#Link to variable info
https://github.com/rfordatascience/tidytuesday/blob/main/data/2024/2024-05-07/readme.md

# Exploration of data

## plotting by year

```{r year}
rolling_stone %>%
  ggplot(aes(x = release_year)) +
  geom_histogram() +
  scale_x_continuous(breaks = seq(1950, 2020, by = 5)) +
  scale_y_continuous(breaks = seq(0, 100, by = 10)) +
  labs(title = "Rolling Stone Album Rankings for 2024",
       x = "Release Year",
       y = "Frequency") +
  theme_classic()
```

##diff by year
```{r diff_by_year_plot}
rolling_stone %>%
  ggplot(aes(x = release_year, y = differential)) +
  geom_point() +
  scale_x_continuous(breaks = seq(1950, 2020, by = 5)) +
  scale_y_continuous(breaks = seq(-500, 500, by = 50)) +
  labs(title = "Rolling Stone Album Rankings for 2024",
       x = "Release Year",
       y = "Change in Ranking From 2003 to 2020") +
  theme_classic()
```

## genre
```{r genre}
rolling_stone %>%
  mutate(genre = fct_infreq(genre)) %>%
  ggplot(aes(x = genre)) +
  geom_bar() +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
  labs(x = "Genre", y = "Number of Albums", title = "Album Counts by Genre")
```

## genre by rs_year
```{r genre_facet}
rolling_stone_long %>%
  mutate(genre = fct_infreq(genre)) %>%
  ggplot(aes(x = genre)) +
  geom_bar() +
  facet_wrap(~rs_year) +  # Facet by year (e.g., 2003, 2012, 2020)
  theme_classic() +
  theme(
    axis.text.x = element_text(angle = 60, hjust = 1),
    strip.background = element_blank(),
    strip.text = element_text(face = "bold")
  ) +
  labs(
    x = "Genre",
    y = "Number of Albums",
    title = "Album Counts by Genre Across Rolling Stone Rankings"
  )
```

## genre by rs_year table
```{r granre_table}
genre_table <- rolling_stone_long %>%
  count(rs_year, genre) %>%
  pivot_wider(names_from = rs_year, values_from = n, values_fill = 0)
print(genre_table)
```

```{r genre_table_mutate}
genre_table <- genre_table %>%
  mutate(diff_2003_2020 = `2020` - `2003`)
```