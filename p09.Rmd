---
title: "Portfolio 9"
---

This portfolio project is on the TidyTuesday dataset from august 25th 2020 on the Chopped tv show.

#libraries
```{r libraries}
library(tidyverse)
library(tidytuesdayR)
library(ggplot2)
library(lme4)
```

#data
```{r getchoppeddata}
chopped <- readr::read_tsv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2020/2020-08-25/chopped.tsv')

```

#long
```{r judgetolong}
chopped_long <- chopped %>%
  pivot_longer(
    cols = starts_with("judge"),
    names_to = "judge_position",
    values_to = "judge"
  ) %>%
  mutate(judge = as.factor(judge))
```



#exploratory 
##season*rating
```{r scatterplot_season*rating}
chopped %>%
  ggplot(aes(x = season, y = episode_rating)) +
  geom_jitter() +
  geom_smooth(method = "lm") +
  labs(title = "Scatterplot of Season vs. Rating",
       x = "Season",
       y = "Rating") +
  theme_minimal()
```


#exploring judge_combos
```{r judgcombodata}
chopped_with_combo <- chopped %>%
  rowwise() %>%
  mutate(
    judge_combo = paste(sort(c(judge1, judge2, judge3)), collapse = " + ")
  ) %>%
  ungroup()

combo_ratings <- chopped_with_combo %>%
  group_by(judge_combo) %>%
  summarize(
    avg_rating = mean(episode_rating, na.rm = TRUE),
    n_episodes = n()
  ) %>%
  filter(n_episodes >= 2) %>%
  arrange(desc(avg_rating)) 
   


combo_ratings$judge_combo <- as.factor(combo_ratings$judge_combo)

```

#tryingagain
```{r longer}
judge_counts <- chopped_long %>%
  group_by(judge) %>%
  summarise(episode_count = n())  # Count episodes per judge

# Filter out judges who were in fewer than 3 episodes
chopped_long_filtered <- chopped_long %>%
  filter(judge %in% judge_counts$judge[judge_counts$episode_count >= 5])

# Preview the filtered data
head(chopped_long_filtered)
```

#

```{r model}
model <- lmer(episode_rating ~ judge + (1 | season_episode), data = chopped_long_filtered)

# Summary of the model
summary(model)
```


###fixthis

```{r meow}
judges_long <- chopped %>%
  pivot_longer(
    cols = c(judge1, judge2, judge3),
    names_to = "judge_position",
    values_to = "judge"
  ) %>%
  distinct(series_episode, judge, episode_rating)  # optional, in case of duplicates

# Step 2: Convert to wide format with one-hot encoding for each judge
judges_wide <- judges_long %>%
  mutate(present = 1) %>%
  pivot_wider(
    names_from = judge,
    values_from = present,
    values_fill = list(present = 0)
  )

# Step 3: Run a linear regression to see which judges predict higher ratings
model <- lm(episode_rating ~ ., data = judges_wide %>% 
              select(-series_episode))

# Step 4: View results
summary(model)
```
