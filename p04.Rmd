---
title: "Portfolio 4"
---

```{r load-packages, message=FALSE}
library(tidyverse) 
library(ggplot2)
library(viridis)

```



```{r getdata}
palmtrees <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-03-18/palmtrees.csv')

```
exploratory graphs looking at the data

```{r summarystats}
palmtrees %>%
  ggplot(aes(x = max_stem_height_m)) +
  geom_histogram()
  
  palmtrees %>%
    ggplot(aes(x = max_stem_height_m)) +
  geom_histogram()+
  facet_wrap(~palm_subfamily)
  
  palmtrees %>%
    ggplot(aes(x = max_stem_height_m)) +
  geom_histogram()+
  facet_wrap(~fruit_shape)

   palmtrees %>%
    ggplot(aes(x = max_leaf_number)) +
  geom_histogram()+
  facet_wrap(~understorey_canopy)
   
palmtrees %>%
    ggplot(aes(x = max__blade__length_m)) +
  geom_histogram()+
  facet_wrap(~understorey_canopy)
  
```


Based on my exploratory results I want to create some good plot to tell a story about how canopy and understory palms differ.

Quick googling showed me that canopy trees are those that are taller and receive more sunlight and wind compared to understory trees that receive less sunlight compared to the canopy trees.

#hypothesis

Some hypotheses that I have are:
1 Canopy trees are taller than understory trees 
2 Fruit type will be different between groups (conspicuousness)
3 *exploratory* understorey trees might have more defenses compared to canopy trees (stem or leaves being armed)

#data_cleaning
```{r cleaning}
palmtrees_clean <- palmtrees %>%
  filter(understorey_canopy %in% c("canopy", "understorey"))
```

#h_1_taller
##t test

```{r taller}
palmtrees_clean %>%
  t.test(max_stem_height_m ~ understorey_canopy, data = .)
 
```

##violin_plot
```{r height_violin_plot}
palmtrees_clean %>%
  ggplot(aes(x = understorey_canopy, y = max_stem_height_m, fill = understorey_canopy)) +
  geom_violin() +
   scale_x_discrete(
    name   = "Understorey vs Canopy",          
    labels = c(
      canopy      = "Canopy",
      understorey = "Understorey")) +
  scale_fill_viridis_d(
    name   = "Type of Palm",
    labels = c(
      canopy      = "Canopy",
      understorey = "Understorey") ) +
  labs( y = "Max Stem Height (m)", 
        title = "Max Stem Height of Canopy vs Understorey Palms") +
  theme_classic()
  
```

##conclusion
Yes, the canopy palms appear to be much taller compared to the understorey palms. On average they are 14.78904 to 16.41920 (95% CI) meters taller.

#h_2_fruit
##testing_proportion
```{r conspiciousness}
tbl <- table(
  palmtrees_clean$understorey_canopy,
  palmtrees_clean$conspicuousness
)
prop.table(tbl, margin = 1)

prop.test(
  x = c(
    tbl["canopy",      "conspicuous"],    # successes in canopy
    tbl["understorey", "conspicuous"]     # successes in understory
  ),
  n = c(
    sum(tbl["canopy", ]),                 # total canopy palms
    sum(tbl["understorey", ])             # total understory palms
  )
)
```

##bar_plot
```{r fruit_bar_plot}
palmtrees_clean %>%
  filter(
    understorey_canopy %in% c("canopy", "understorey"),
    !is.na(conspicuousness)
  ) %>%
  ggplot(aes(x = understorey_canopy, fill = conspicuousness, na.rm = TRUE)) +
  geom_bar(position = "fill") +
  scale_x_discrete(
    name   = "Understorey vs Canopy",          
    labels = c(
      canopy      = "Canopy",
      understorey = "Understorey")) +
  scale_fill_viridis_d(
    name   = "Conspicuousness",
    labels = c(
      conspicuous      = "Conspicuous",
      inconspicuous = "Inconspicuous") ) +
  labs( y = "Proportion of Palms", 
        title = "Proportion of Conspicuousness of Canopy vs Understorey Palms") +
  theme_classic()
```


##conclusion

There is a statistically significant difference in the proportion of conspicuous fruit between canopy and understorey palms. Understorey palms are more likely to have conspiciuous fruit--meaning they are brighter in color--compared to canopy palms who are more likely to have cryptic fruit--colors making them harder to see.

This might be because understorey palms may be in darker environments, meaning that they need to have brighter colored fruit in order to disperse their seeds where bright colors are not as adventatgeous in the canopy regions. 
